<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ›‹ï¸ Äá»“ Ná»™i Tháº¥t Store</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="navbar">
    <div class="nav-container">
      <a class="nav-logo" href="index.html">
        <div class="logo-mark">ğŸ›‹ï¸</div>
        <div class="logo-text">Äá»“ Ná»™i Tháº¥t <span>Store</span></div>
      </a>

      <nav class="main-nav" aria-label="ChuyÃªn má»¥c">
        <a href="#" onclick="filterCategory('all');return false;">Táº¥t cáº£</a>
        <a href="#" onclick="filterCategory('PhÃ²ng khÃ¡ch');return false;">PhÃ²ng khÃ¡ch</a>
        <a href="#" onclick="filterCategory('PhÃ²ng ngá»§');return false;">PhÃ²ng ngá»§</a>
        <a href="#" onclick="filterCategory('PhÃ²ng báº¿p');return false;">PhÃ²ng báº¿p</a>
        <a href="#" onclick="filterCategory('VÄƒn phÃ²ng');return false;">VÄƒn phÃ²ng</a>
        <a href="#" onclick="filterCategory('Trang trÃ­');return false;">Trang trÃ­</a>
      </nav>

      <div class="nav-user" onclick="toggleDropdown()" tabindex="0" role="button">
        <img id="avatar" class="user-avatar" src="avatar.jpg" alt="avatar" />
        <div class="user-meta">
          <div id="usernameDisplay" class="username"></div>
          <div class="small-muted">TÃ i khoáº£n</div>
        </div>
        <div id="dropdown" class="dropdown-menu">
          <a href="add-do.html">â• ThÃªm Ä‘á»“</a>
          <a href="settings.html">âš™ CÃ i Ä‘áº·t</a>
          <a href="#" onclick="logout(); return false;">ğŸšª ÄÄƒng xuáº¥t</a>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="hero">
      <div>
        <h1>Trang bÃ¡n ná»™i tháº¥t hiá»‡n Ä‘áº¡i</h1>
        <p>Chá»n lá»±a ná»™i tháº¥t áº¥m Ã¡p, cÃ¡ tÃ­nh â€” phÃ¹ há»£p khÃ´ng gian sinh hoáº¡t & há»c táº­p.</p>
        <p>Ná»™i tháº¥t Ä‘Æ°á»£c tuyá»ƒn chá»n ká»¹ lÆ°á»¡ng, Ä‘áº£m báº£o cháº¥t lÆ°á»£ng vÃ  tÃ­nh tháº©m má»¹ cao.</p> 
      </div>
    </div>

    <section style="margin-top: 26px;">
      <h2>Bá»™ sÆ°u táº­p</h2>
      <p id="count" class="muted"></p>
      <div id="productList" class="grid-products"></div>

      <div class="pagination">
        <button class="btn ghost" onclick="prevPage()">â—€ TrÆ°á»›c</button>
        <span id="pageInfo" class="page-info"></span>
        <button class="btn ghost" onclick="nextPage()">Tiáº¿p â–¶</button>
      </div>
    </section>
  </main>

<script>
let products = [];
let allProducts = [];
let page = 1;
const perPage = 6;
let currentUser = JSON.parse(localStorage.getItem("currentUser") || "{}");

function formatPrice(p){ if(!p && p !== 0) return "(ChÆ°a cÃ³ giÃ¡)"; return Number(p).toLocaleString('vi-VN') + " Ä‘"; }

function getUserFullname(username){
  const users = JSON.parse(localStorage.getItem("users") || "[]");
  const u = users.find(x=>x.username===username);
  return u ? u.fullname : (username || "NgÆ°á»i dÃ¹ng áº©n danh");
}

function render(){
  const start = (page-1)*perPage;
  const list = products.slice(start, start+perPage);

  document.getElementById("count").textContent = "Tá»•ng sá»‘: " + allProducts.length + " sáº£n pháº©m";

  document.getElementById("productList").innerHTML = list.map(p => {
    const isCreator = currentUser && currentUser.username === p.creator;
    const creatorName = getUserFullname(p.creator);
    const priceText = p.price ? Number(p.price).toLocaleString('vi-VN') + " Ä‘" : "(ChÆ°a cÃ³ giÃ¡)";

    const actionButtons = isCreator ? `
      <div class="product-actions">
        <button class="btn small-btn ghost" onclick="event.stopPropagation(); editProduct('${p.id}');">Sá»­a</button>
        <button class="btn small-btn danger" onclick="event.stopPropagation(); deleteProduct('${p.id}');">XÃ³a</button>
      </div>` : "";

    return `
    <article class="product-card" onclick="goDetail('${p.id}')">
      <div class="card-media">
        <img src="${p.image || 'avatar.jpg'}" alt="${p.name}">
      </div>
      <div class="card-body">
        <h3>${p.name || '(KhÃ´ng tÃªn)'}</h3>
        <div class="meta-row">
          <span class="muted">${p.category || '-'}</span>
          <span class="price">${priceText}</span>
        </div>
        <div class="card-foot">
          <div class="posted-by">ÄÄƒng: <b>${creatorName}</b></div>
          ${actionButtons}
        </div>
      </div>
    </article>`;
  }).join("");

  document.getElementById("pageInfo").textContent =
    "Trang " + page + " / " + Math.max(1, Math.ceil(products.length / perPage));
}

function goDetail(id){ location.href = "detail.html?id=" + id; }
function editProduct(id){ location.href = "add-do.html?id=" + id; }
function nextPage(){ if (page * perPage < products.length) page++; render(); }
function prevPage(){ if (page > 1) page--; render(); }
function toggleDropdown(){ document.getElementById("dropdown").classList.toggle("show"); }
function filterCategory(cat){
  if (cat === "all") products = [...allProducts];
  else products = allProducts.filter(p=>p.category === cat);
  page = 1; render();
}
function logout(){ localStorage.removeItem("currentUser"); location.href = "login.html"; }

function deleteProduct(id){
  if (!confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a sáº£n pháº©m nÃ y?")) return;
  let list = JSON.parse(localStorage.getItem("products") || "[]");
  list = list.filter(p => String(p.id) !== String(id));
  localStorage.setItem("products", JSON.stringify(list));
  allProducts = list;
  products = [...allProducts];
  render();
  alert("ÄÃ£ xÃ³a sáº£n pháº©m.");
}

function loadProducts(){
  currentUser = JSON.parse(localStorage.getItem("currentUser") || "{}");
  document.getElementById("usernameDisplay").textContent = currentUser.fullname || "KhÃ¡ch";
  document.getElementById("avatar").src = currentUser.avatar || "avatar.jpg";

  allProducts = JSON.parse(localStorage.getItem("products") || "[]");

  // Náº¿u chÆ°a cÃ³ sáº£n pháº©m, thÃªm 20 sáº£n pháº©m máº«u
  if(allProducts.length === 0){
    const sampleProducts = [
      { id: String(Date.now()+1), name: "Gháº¿ sofa da", category: "PhÃ²ng khÃ¡ch", price: 5000000, creator: "admin", image: "sofa1.jpg" },
      { id: String(Date.now()+2), name: "BÃ n trÃ  gá»—", category: "PhÃ²ng khÃ¡ch", price: 1200000, creator: "admin", image: "ban-tra.jpg" },
      { id: String(Date.now()+3), name: "Tá»§ ká»‡ TV", category: "PhÃ²ng khÃ¡ch", price: 3500000, creator: "admin", image: "tu-tv.jpg" },
      { id: String(Date.now()+4), name: "GiÆ°á»ng ngá»§ gá»—", category: "PhÃ²ng ngá»§", price: 7000000, creator: "admin", image: "giuong-ngu.jpg" },
      { id: String(Date.now()+5), name: "Tá»§ quáº§n Ã¡o", category: "PhÃ²ng ngá»§", price: 4000000, creator: "admin", image: "tu-quan-ao.jpg" },
      { id: String(Date.now()+6), name: "BÃ n há»c sinh", category: "PhÃ²ng ngá»§", price: 1200000, creator: "admin", image: "ban-hoc.jpg" },
      { id: String(Date.now()+7), name: "BÃ n Äƒn trÃ²n", category: "PhÃ²ng báº¿p", price: 3000000, creator: "admin", image: "ban-an.jpg" },
      { id: String(Date.now()+8), name: "Gháº¿ Äƒn", category: "PhÃ²ng báº¿p", price: 800000, creator: "admin", image: "ghe-an.jpg" },
      { id: String(Date.now()+9), name: "Tá»§ láº¡nh mini", category: "PhÃ²ng báº¿p", price: 2500000, creator: "admin", image: "tu-lanh.jpg" },
      { id: String(Date.now()+10), name: "BÃ n lÃ m viá»‡c", category: "VÄƒn phÃ²ng", price: 2000000, creator: "admin", image: "ban-lam-viec.jpg" },
      { id: String(Date.now()+11), name: "Gháº¿ vÄƒn phÃ²ng", category: "VÄƒn phÃ²ng", price: 1500000, creator: "admin", image: "ghe-van-phong.jpg" },
      { id: String(Date.now()+12), name: "Ká»‡ sÃ¡ch", category: "VÄƒn phÃ²ng", price: 1800000, creator: "admin", image: "ke-sach.jpg" },
      { id: String(Date.now()+13), name: "Tranh treo tÆ°á»ng", category: "Trang trÃ­", price: 600000, creator: "admin", image: "tranh-treo.jpg" },
      { id: String(Date.now()+14), name: "ÄÃ¨n bÃ n", category: "Trang trÃ­", price: 400000, creator: "admin", image: "den-ban.jpg" },
      { id: String(Date.now()+15), name: "Tháº£m tráº£i sÃ n", category: "Trang trÃ­", price: 900000, creator: "admin", image: "tham.jpg" },
      { id: String(Date.now()+16), name: "Gháº¿ bÃ nh thÆ° giÃ£n", category: "PhÃ²ng khÃ¡ch", price: 4500000, creator: "admin", image: "ghe-banh.jpg" },
      { id: String(Date.now()+17), name: "BÃ n console", category: "PhÃ²ng khÃ¡ch", price: 2200000, creator: "admin", image: "ban-console.jpg" },
      { id: String(Date.now()+18), name: "GiÆ°á»ng táº§ng tráº» em", category: "PhÃ²ng ngá»§", price: 6500000, creator: "admin", image: "giuong-tang.jpg" },
      { id: String(Date.now()+19), name: "Gháº¿ bar", category: "PhÃ²ng báº¿p", price: 900000, creator: "admin", image: "ghe-bar.jpg" },
      { id: String(Date.now()+20), name: "ÄÃ¨n tráº§n hiá»‡n Ä‘áº¡i", category: "Trang trÃ­", price: 1200000, creator: "admin", image: "den-tran.jpg" },
    ];
    localStorage.setItem("products", JSON.stringify(sampleProducts));
    allProducts = [...sampleProducts];
    alert("ÄÃ£ thÃªm 20 sáº£n pháº©m máº«u!");
  }

  allProducts = allProducts.map(p => ({...p, id: String(p.id)}));
  products = [...allProducts];
  page = 1;
  render();
}

loadProducts();
</script>

<footer class="footer">
  <div class="footer-container">
    <div class="footer-col">
      <h3>Báº¯t Ä‘áº§u mua sáº¯m</h3>
      <a href="#">ÄÄƒng kÃ½ tÃ i khoáº£n</a>
      <a href="#">Äiá»u khoáº£n bÃ¡n hÃ ng</a>
    </div>
    <div class="footer-col">
      <h3>TÃ i khoáº£n</h3>
      <a href="login.html">ÄÄƒng nháº­p</a>
      <a href="register.html">Táº¡o tÃ i khoáº£n</a>
      <a href="#">Danh sÃ¡ch yÃªu thÃ­ch</a>
    </div>
    <div class="footer-col">
      <h3>Dá»‹ch vá»¥ khÃ¡ch hÃ ng</h3>
      <a href="#">ChÃ­nh sÃ¡ch giao hÃ ng</a>
      <a href="#">PhÆ°Æ¡ng thá»©c thanh toÃ¡n</a>
      <a href="#">ChÃ­nh sÃ¡ch báº£o hÃ nh</a>
      <a href="#">ChÃ­nh sÃ¡ch Ä‘á»•i tráº£</a>
      <a href="#">CÃ¢u há»i thÆ°á»ng gáº·p</a>
    </div>
    <div class="footer-col">
      <h3>LiÃªn há»‡</h3>
      <p>ğŸ“ 0377427739 (Hotline/Zalo)</p>
      <p>âœ‰ï¸ hotro@noithat.vn</p>
    </div>
  </div>
  <div class="footer-bottom">
    Â© 2025 Ná»™i Tháº¥t Store â€” Thiáº¿t káº¿ bá»Ÿi ThÃ nh CÃ´ng
  </div>
</footer>
</body>
</html>
